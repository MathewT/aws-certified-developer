# VPC Study and Exam Notes

:sparkles: [VPC FAQ](https://aws.amazon.com/vpc/faqs/)

:sparkles: [VPC Documentation](https://aws.amazon.com/documentation/vpc/)

A VPC is a logical data center in an AWS region.  VPCs span AZs but not regions.  

A VPC consists of:
  - an IGW or Virtual Private Gateway
  - Route tables
  - Network ACLs
  - Subnets
  - Security Groups


![VPC Basic Diagram](https://github.com/MathewT/aws-certified-developer/blob/master/VPC/vpc-basic-diagram.JPG)

1. Two routes of entry into the VPC:  Internet gateway or Virtual Private Gateway
1. Internet gateway, for connecting to/from the Internet
1. Virtual Private Gateway, for VPN connection termination (e.g. to data center)



**Exam Tip**: 1 subnet = 1 availability zone (AZ).  Subnets cannot span across multiple AZs.  
**Exam Tip**: Security Groups can span multiple subnets and AZs.  
**Exam Tip**: Only one Internet gateway per VPC

## Default VPC vs Custom VPC

1. Default VPCs are user friendly allowing you to immediately deploy instances
1. All subnets in a default VPC have a route out to the Internet.  They're all public.
1. Each EC2 instance deployed in the default VPC has a public and private IP address.
1. If you delete the default VPC, the only way to recover is to contact AWS.

## VPC Peering
1. Connect VPCs within a region via direct network route using private IP addresses, traffic doesn't go out over the Internet
1. Instances behave as though on the same private network
1. VPCs can be peered with other AWS accounts
1. Peering is in a star configuration: 1 central VPC peers with 4 others.  **NO TRANSITIVE PEERING!**  
1. You cannot talk to one VPC via another peered VPC


## Creating a Custom VPC

**Exam Tip**: IGW and Subnets not created by default.   Default security group, NACL and route table are created.
**Exam Tip**: In a VPC, the maximum addressable network size is /16; Always use /16 network (10.0.0.0/16) for VPC

1. Leave the default route table alone.
1. Create a new route table
1. In the new route table, route all public traffic through the IGW
1. **Note:**  When you create a new subnet, it is associated to the main route table by default!
1. In the new public route table, edit the assigned subnets and assign the "public" subnet to public 
route table
1. Modify the auto-assign public IP setting for the public subnet to Yes

## NAT Instance

**Exam Tip** Disable source/destination check

## NAT Gateway
1. No security group
1. Put in public subnet
1. Update private route table to use the NAT gateway for Internet access



