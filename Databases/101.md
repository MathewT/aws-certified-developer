# Databases

## Automated Backups
  - Allow you to recover your database to any point in time (to the second) during the 
  "retention period"
  - Default retention period in RDS is 7 days
  - Retention persiod is 1 day to 35 days
  - Full daily snapshot and store transaction logs in S3 - free equal to the size of your database
  - Allows recovery to a specific point in time during the retention period
  - Backups are taken during a pre-defined window
  - Datbase I/O may be suspended during backups causing application latency!
  
## Snapshots
  - Manual
  - User initiated via console

## Restore
  - Whenever you restore from automated or snapshot backup, the restored database is a 
  new RDS instance with an new DNS endpoint
  - Restore a snapshot or automated backup to a larger instance to scale up the database 
  server
  
## Encryption
  - Encryption at rest supported for MySQL, Oracle, MariaDB, SQL Server, Postgres
  - Uses AWS Key Management System (KMS) 
  - Encryption must be enabled at the time the database is created, not supported 
  after the database is already created
  - Everything gets encrypted:  data on disk, snapshots, automated backups
  - Create encrypted database and import data from unencrypted export (not backup or snapshot)
 
## Multi-AZ
  - RDS database in us-east-1 AZ does a **synchronous** copy to a different AZ (e.g. us-east-2)
  - If us-east-1 instance fails, AWS will auto failover to us-east-2, no need to change 
  the DNS endpoint.
  - **Exam tip:  **For disaster recovery (DR) only.  Not for performance or scaling
  - SQL Server, Oracle, MySQL, Postgres, MariaDB

## Read Replicas
  - Master database asynchronously writes to read only database replicas
  - For read heavy applications, EC2 instances are configured to point to read replicas
  - You can have read replicas of read replicas
  - Main database -> five read replicas
  - MySQL, Postgres, MariaDB
  - Not supported in Oracle or SQL Server
  - **Exam tip:  **Read replicas are for scaling, NOT for DR
  - Must have automated backups turned on for read replicas
  - Up to 5 read replica copies of one main database
  - Could be latency of data in a read replica
  - Each read replica will have its own DNS endpoint
  - Read replicas cannot be Multi-AZ
  - You can have read replicas of primary source Multi AZ databases
  - Read replicas can be promoted to primary source databases, breaks the read replica relationship
  - You can have read replicas in second regioin for MySQL and MariaDB only
  - Read replicas can be in a different AZ than the primary
 
## DynamoDB vs RDS
  - DynamoDB offers push-button scaling, no downtime for database scaling
  - RDS is more complicated, upgrade to a larger instance size or add read replicas (manual process)
  - RDS writes can only scale up via bigger hardware and only scale out (horizontal scale) for reads 
  (read replicas)
  - Choose DynamoDB for scaling without downtime
  - 
  
